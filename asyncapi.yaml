asyncapi: "2.6.0"
info:
  title: dieKlingel Core
  version: 1.0.0
  description: This core webrtc api
channels:
  $CORE_DEVICE_ID/connections/offer:
    subscribe:
      message:
        $ref: "#/components/messages/ConnectionDescriptionMessage"
  $SENDER_DEVICE_ID/connections/answer:
    publish:
      message:
        $ref: "#/components/messages/ConnectionDescriptionMessage"
  $CORE_DEVICE_ID/connections/candidate:
    subscribe:
      message:
        $ref: "#/components/messages/ConnectionCandidateMessage"
  $SENDER_DEVICE_ID/connections/candidate:
    publish:
      message:
        $ref: "#/components/messages/ConnectionCandidateMessage"
  $CORE_DEVICE_ID/connections/close:
    subscribe:
      message:
        $ref: "#/components/messages/ConnectionCloseMessage"
  $SENDER_DEVICE_ID/connections/close:
    publish:
      message:
        $ref: "#/components/messages/ConnectionCloseMessage"

components:
  messages:
    ConnectionDescriptionMessage:
      payload:
        type: object
        properties:
          headers:
            type: object
            properties:
              senderDeviceId:
                type: string
              sessionId:
                type: string
          body:
            type: object
            properties:
              sessionDescription:
                type: object
                properties:
                  type:
                    type: number
                  sdp:
                    type: string
    ConnectionCandidateMessage:
      payload:
        type: object
        properties:
          headers:
            type: object
            properties:
              senderDeviceId:
                type: string
              sessionId:
                type: string
          body:
            type: object
            properties:
              iceCandidate:
                type: object
                properties:
                  foundation:
                    type: string
                  priority:
                    type: number
                  address:
                    type: string
                  protocol:
                    type: number
                  port:
                    type: number
                  type:
                    type: number
                  component:
                    type: number
                  relatedAddress:
                    type: string
                  realatedPort:
                    type: number
                  tcpType:
                    type: string
    ConnectionCloseMessage:
      payload:
        type: object
        properties:
          headers:
            type: object
            properties:
              senderDeviceId:
                type: string
              sessionId:
                type: string
